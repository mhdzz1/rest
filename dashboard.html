<!DOCTYPE html>
<html>

<head>
    <title>Admin Dashboard - GOGO Pizza</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amatic+SC">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: "Amatic SC", sans-serif
        }

        .dashboard-bg {
            background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%);
            min-height: 100vh;
            padding-bottom: 40px;
        }

        .dashboard-header {
            text-align: center;
            color: #fff;
            padding: 40px 10px 20px 10px;
        }

        .dashboard-header h1 {
            font-size: 60px;
            letter-spacing: 3px;
            margin-bottom: 10px;
            color: #ffeb3b;
            text-shadow: 2px 2px 8px #000;
        }

        .dashboard-header p {
            font-size: 28px;
            color: #fff;
            text-shadow: 1px 1px 6px #000;
        }

        .dashboard-cards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 24px;
            margin-bottom: 32px;
        }

        .dashboard-card {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 8px 32px #0002;
            min-width: 280px;
            max-width: 350px;
            flex: 1 1 280px;
            padding: 24px 20px 20px 20px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .dashboard-card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 16px 48px #0003;
        }

        .dashboard-icon {
            font-size: 42px;
            color: #ff9800;
            margin-bottom: 10px;
        }

        .dashboard-title {
            font-size: 32px;
            color: #ff5722;
            margin-bottom: 6px;
        }

        .dashboard-value {
            font-size: 28px;
            color: #388e3c;
            font-weight: bold;
        }

        .dashboard-section {
            margin: 24px auto;
            max-width: 1200px;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 8px 32px #0002;
            padding: 24px 20px 20px 20px;
        }

        .dashboard-section h2 {
            font-size: 36px;
            color: #ff5722;
            margin-bottom: 16px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .section-nav {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .section-nav button {
            font-size: 20px;
            color: #fff;
            background: #ff9800;
            border: none;
            border-radius: 16px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .section-nav button.active,
        .section-nav button:hover {
            background: #ff5722;
        }

        .section-content {
            display: none;
        }

        .section-content.active {
            display: block;
        }

        .modern-card-form {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 8px 32px #0002;
            max-width: 500px;
            margin: 0 auto 24px auto;
            padding: 0 0 20px 0;
        }

        .form-header {
            background: #ff9800;
            color: #fff;
            padding: 16px 20px;
            border-radius: 20px 20px 0 0;
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-content {
            padding: 20px;
        }

        .modern-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-size: 20px;
            color: #ff5722;
            font-weight: bold;
        }

        .modern-input {
            padding: 12px 16px;
            border: 2px solid #eee;
            border-radius: 12px;
            font-size: 18px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .modern-input:focus {
            outline: none;
            border-color: #ff9800;
        }

        .modern-submit-btn {
            background: #ff5722;
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 20px;
            cursor: pointer;
            transition: background 0.2s;
            font-family: inherit;
        }

        .modern-submit-btn:hover {
            background: #e64a19;
        }

        .dashboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }

        .dashboard-table th,
        .dashboard-table td {
            border: 1px solid #eee;
            padding: 8px 6px;
            text-align: center;
            font-size: 18px;
        }

        .dashboard-table th {
            background: #ff9800;
            color: #fff;
            font-size: 20px;
        }

        .dashboard-table img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 6px;
        }

        .delete-btn {
            background: #ff5722;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .delete-btn:hover {
            background: #d32f2f;
        }

        .edit-btn {
            background: #ff9800;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s;
            margin-right: 6px;
        }

        .edit-btn:hover {
            background: #f57c00;
        }

        .category-item {
            display: inline-block;
            background: #ffe0b2;
            color: #ff5722;
            border-radius: 16px;
            padding: 8px 16px;
            margin: 4px 8px 4px 0;
            font-size: 18px;
            position: relative;
        }

        .category-delete {
            background: none;
            border: none;
            color: #ff5722;
            font-size: 18px;
            cursor: pointer;
            margin-left: 8px;
            padding: 0 4px;
        }

        .category-delete:hover {
            color: #d32f2f;
        }

        .ingredient-item {
            display: inline-block;
            background: #e8f5e8;
            color: #388e3c;
            border-radius: 16px;
            padding: 8px 16px;
            margin: 4px 8px 4px 0;
            font-size: 18px;
            position: relative;
        }

        .ingredient-delete {
            background: none;
            border: none;
            color: #388e3c;
            font-size: 18px;
            cursor: pointer;
            margin-left: 8px;
            padding: 0 4px;
        }

        .ingredient-delete:hover {
            color: #d32f2f;
        }

        .staff-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .staff-card {
            background: #f9f9f9;
            border-radius: 16px;
            padding: 20px;
            border: 2px solid #eee;
            transition: border-color 0.2s;
        }

        .staff-card:hover {
            border-color: #ff9800;
        }

        .staff-name {
            font-size: 24px;
            color: #ff5722;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .staff-position {
            font-size: 18px;
            color: #666;
            margin-bottom: 6px;
        }

        .staff-contact {
            font-size: 16px;
            color: #888;
            margin-bottom: 4px;
        }

        .staff-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }

        /* Edit Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .edit-modal {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            background: #ff9800;
            color: #fff;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 30px;
        }

        .modal-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .image-preview {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f9f9f9;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }

        .image-preview.empty {
            color: #999;
            font-size: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .btn-secondary {
            background: #6c757d;
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        @media (max-width: 900px) {
            .dashboard-cards {
                flex-direction: column;
                gap: 16px;
            }

            .dashboard-card {
                min-width: 0;
                max-width: 98vw;
            }

            .dashboard-section {
                padding: 16px 4px;
            }

            .section-nav {
                flex-direction: column;
                align-items: center;
            }

            .staff-grid {
                grid-template-columns: 1fr;
            }

            .edit-modal {
                width: 95%;
                max-height: 95vh;
            }

            .modal-body {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .modal-actions {
                flex-direction: column;
                gap: 10px;
            }

            .modal-actions button {
                width: 100%;
            }
        }

        @media (max-width: 600px) {
            .dashboard-header h1 {
                font-size: 36px;
            }

            .dashboard-header p {
                font-size: 18px;
            }

            .dashboard-title {
                font-size: 24px;
            }

            .dashboard-value {
                font-size: 20px;
            }

            .dashboard-section h2 {
                font-size: 28px;
            }

            .dashboard-table th,
            .dashboard-table td {
                font-size: 14px;
                padding: 4px 2px;
            }
        }
    </style>
</head>

<body>
    <div class="dashboard-bg">
        <div class="dashboard-header">
            <h1><i class="fa-solid fa-chart-line"></i> GOGO Pizza Admin</h1>
            <p>Restaurant Management Dashboard</p>
        </div>

        <!-- Overview Cards -->
        <div class="dashboard-cards">
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-shopping-cart"></i></div>
                <div class="dashboard-title">Total Orders</div>
                <div class="dashboard-value" id="totalOrders">0</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-dollar-sign"></i></div>
                <div class="dashboard-title">Total Revenue</div>
                <div class="dashboard-value" id="totalRevenue">$0</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-pizza-slice"></i></div>
                <div class="dashboard-title">Menu Items</div>
                <div class="dashboard-value" id="totalMenuItems">0</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-users"></i></div>
                <div class="dashboard-title">Staff Members</div>
                <div class="dashboard-value" id="totalStaff">0</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-carrot"></i></div>
                <div class="dashboard-title">Ingredients</div>
                <div class="dashboard-value" id="totalIngredients">0</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-icon"><i class="fa-solid fa-exclamation-triangle"></i></div>
                <div class="dashboard-title">Low Stock Items</div>
                <div class="dashboard-value" id="lowStockItems">0</div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="dashboard-section">
            <div class="section-nav">
                <button onclick="showSection('orders')" class="active">
                    <i class="fa-solid fa-shopping-cart"></i> Order History
                </button>
                <button onclick="showSection('menu')">
                    <i class="fa-solid fa-pizza-slice"></i> Menu Items
                </button>
                <button onclick="showSection('ingredients')">
                    <i class="fa-solid fa-carrot"></i> Ingredients
                </button>
                <button onclick="showSection('categories')">
                    <i class="fa-solid fa-folder"></i> Categories
                </button>
                <button onclick="showSection('staff')">
                    <i class="fa-solid fa-users"></i> Staff
                </button>
            </div>

            <!-- Order History Section -->
            <div id="orders-section" class="section-content active">
                <h2><i class="fa-solid fa-shopping-cart"></i> Order History</h2>
                <div id="ordersList"></div>
            </div>

            <!-- Menu Items Section -->
            <div id="menu-section" class="section-content">
                <h2><i class="fa-solid fa-pizza-slice"></i> Menu Items</h2>

                <!-- Add Menu Item Form -->
                <div class="modern-card-form">
                    <div class="form-header">
                        <i class="fa-solid fa-plus"></i> Add New Menu Item
                    </div>
                    <div class="form-content">
                        <form id="addMenuItemForm" class="modern-form">
                            <div class="form-group">
                                <label><i class="fa-solid fa-pizza-slice"></i> Name</label>
                                <input class="modern-input" type="text" placeholder="Menu Item Name" name="name"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-align-left"></i> Description</label>
                                <input class="modern-input" type="text" placeholder="Description" name="description"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-dollar-sign"></i> Price</label>
                                <input class="modern-input" type="number" step="0.01" placeholder="Price" name="price"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-layer-group"></i> Category</label>
                                <select class="modern-input" name="category" id="addCategorySelect" required>
                                    <!-- Options will be loaded dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-image"></i> Image</label>
                                <input class="modern-input" type="file" name="image" accept="image/*">
                            </div>
                            <button class="modern-submit-btn" type="submit">
                                <i class="fa-solid fa-plus"></i> Add Menu Item
                            </button>
                            <div id="addMenuItemMsg" style="color:#ff5722;font-size:16px;margin-top:6px;"></div>
                        </form>
                    </div>
                </div>

                <!-- Menu Items List -->
                <div id="menuItemsList"></div>
            </div>

            <!-- Ingredients Section -->
            <div id="ingredients-section" class="section-content">
                <h2><i class="fa-solid fa-carrot"></i> Ingredients Management</h2>

                <!-- Add Ingredient Form -->
                <div class="modern-card-form">
                    <div class="form-header">
                        <i class="fa-solid fa-plus"></i> Add New Ingredient
                    </div>
                    <div class="form-content">
                        <form id="addIngredientForm" class="modern-form">
                            <div class="form-group">
                                <label><i class="fa-solid fa-carrot"></i> Ingredient Name</label>
                                <input class="modern-input" type="text" placeholder="Ingredient Name" name="name"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-tag"></i> Display Name</label>
                                <input class="modern-input" type="text" placeholder="Display Name" name="displayName"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-layer-group"></i> Category</label>
                                <select class="modern-input" name="category" required>
                                    <option value="">Select Category</option>
                                    <option value="dairy">Dairy</option>
                                    <option value="meat">Meat</option>
                                    <option value="vegetables">Vegetables</option>
                                    <option value="fruits">Fruits</option>
                                    <option value="seafood">Seafood</option>
                                    <option value="bakery">Bakery</option>
                                    <option value="sauces">Sauces</option>
                                    <option value="herbs">Herbs</option>
                                    <option value="dry">Dry Goods</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-weight-hanging"></i> Initial Stock (g)</label>
                                <input class="modern-input" type="number" placeholder="1000" name="initialStock"
                                    value="1000" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-ruler"></i> Unit</label>
                                <select class="modern-input" name="unit" required>
                                    <option value="g">Grams (g)</option>
                                    <option value="kg">Kilograms (kg)</option>
                                    <option value="oz">Ounces (oz)</option>
                                    <option value="lb">Pounds (lb)</option>
                                </select>
                            </div>
                            <button class="modern-submit-btn" type="submit">
                                <i class="fa-solid fa-plus"></i> Add Ingredient
                            </button>
                            <div id="addIngredientMsg" style="color:#ff5722;font-size:16px;margin-top:6px;"></div>
                        </form>
                    </div>
                </div>

                <!-- Restock Form -->
                <div class="modern-card-form">
                    <div class="form-header">
                        <i class="fa-solid fa-boxes"></i> Restock Ingredients
                    </div>
                    <div class="form-content">
                        <form id="restockForm" class="modern-form">
                            <div class="form-group">
                                <label><i class="fa-solid fa-carrot"></i> Ingredient</label>
                                <select class="modern-input" id="restockIngredient" required>
                                    <!-- Options will be loaded dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-weight-hanging"></i> Amount</label>
                                <input class="modern-input" type="number" id="restockAmount" placeholder="Amount"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-ruler"></i> Unit</label>
                                <select class="modern-input" id="restockUnit">
                                    <option value="g">Grams (g)</option>
                                    <option value="kg">Kilograms (kg)</option>
                                    <option value="oz">Ounces (oz)</option>
                                    <option value="lb">Pounds (lb)</option>
                                </select>
                            </div>
                            <button class="modern-submit-btn" type="submit">
                                <i class="fa-solid fa-boxes"></i> Restock
                            </button>
                            <div id="restockMsg" style="color:#ff5722;font-size:16px;margin-top:6px;"></div>
                        </form>
                    </div>
                </div>

                <!-- Ingredients List -->
                <div id="ingredientsList"></div>
            </div>

            <!-- Categories Section -->
            <div id="categories-section" class="section-content">
                <h2><i class="fa-solid fa-folder"></i> Categories Management</h2>

                <!-- Add Category Form -->
                <div class="modern-card-form">
                    <div class="form-header">
                        <i class="fa-solid fa-plus"></i> Add New Category
                    </div>
                    <div class="form-content">
                        <form id="addCategoryForm" class="modern-form">
                            <div class="form-group">
                                <label><i class="fa-solid fa-folder"></i> Category Name</label>
                                <input class="modern-input" type="text" placeholder="Category Name" name="name"
                                    id="newCategoryInput" required>
                            </div>
                            <button class="modern-submit-btn" type="submit">
                                <i class="fa-solid fa-plus"></i> Add Category
                            </button>
                            <div id="addCategoryMsg" style="color:#ff5722;font-size:16px;margin-top:6px;"></div>
                        </form>
                    </div>
                </div>

                <!-- Categories List -->
                <div id="categoriesList"></div>
            </div>

            <!-- Staff Section -->
            <div id="staff-section" class="section-content">
                <h2><i class="fa-solid fa-users"></i> Staff Management</h2>

                <!-- Add Staff Form -->
                <div class="modern-card-form">
                    <div class="form-header">
                        <i class="fa-solid fa-plus"></i> Add Staff Member
                    </div>
                    <div class="form-content">
                        <form id="addStaffForm" class="modern-form">
                            <div class="form-group">
                                <label><i class="fa-solid fa-user"></i> Full Name</label>
                                <input class="modern-input" type="text" placeholder="Full Name" name="name" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-briefcase"></i> Position</label>
                                <input class="modern-input" type="text" placeholder="Position" name="position" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-envelope"></i> Email</label>
                                <input class="modern-input" type="email" placeholder="email@example.com" name="email"
                                    required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-phone"></i> Phone</label>
                                <input class="modern-input" type="tel" placeholder="Phone Number" name="phone" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-building"></i> Department</label>
                                <select class="modern-input" name="department" required>
                                    <option value="">Select Department</option>
                                    <option value="Kitchen">Kitchen</option>
                                    <option value="Service">Service</option>
                                    <option value="Delivery">Delivery</option>
                                    <option value="Management">Management</option>
                                    <option value="Marketing">Marketing</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-dollar-sign"></i> Salary</label>
                                <input class="modern-input" type="number" placeholder="Annual Salary" name="salary"
                                    min="0">
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-calendar"></i> Hire Date</label>
                                <input class="modern-input" type="date" name="hireDate">
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-file-alt"></i> CV/Resume</label>
                                <textarea class="modern-input" name="cv" placeholder="Enter CV/Resume details..."
                                    rows="4"></textarea>
                            </div>
                            <div class="form-group">
                                <label><i class="fa-solid fa-toggle-on"></i> Status</label>
                                <select class="modern-input" name="status" required>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                    <option value="On Leave">On Leave</option>
                                </select>
                            </div>
                            <button class="modern-submit-btn" type="submit">
                                <i class="fa-solid fa-plus"></i> Add Staff Member
                            </button>
                            <div id="addStaffMsg" style="color:#ff5722;font-size:16px;margin-top:6px;"></div>
                        </form>
                    </div>
                </div>

                <!-- Staff List -->
                <div id="staffList" class="staff-grid"></div>
            </div>
        </div>
    </div>

    <!-- Edit Menu Item Modal -->
    <div id="editMenuModal" class="modal-overlay">
        <div class="edit-modal">
            <div class="modal-header">
                <h3><i class="fa-solid fa-edit"></i> Edit Menu Item</h3>
                <button class="modal-close" onclick="closeEditModal()">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editMenuForm" class="modal-form">
                    <input type="hidden" id="editItemName" name="oldName">

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-pizza-slice"></i> Name</label>
                            <input class="modern-input" type="text" id="editItemNameInput" name="name" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-dollar-sign"></i> Price</label>
                            <input class="modern-input" type="number" step="0.01" id="editItemPrice" name="price"
                                required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fa-solid fa-align-left"></i> Description</label>
                        <textarea class="modern-input" id="editItemDescription" name="description" rows="3"
                            required></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-layer-group"></i> Category</label>
                            <select class="modern-input" id="editItemCategory" name="category" required>
                                <!-- Options will be loaded dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-image"></i> Current Image</label>
                            <div id="editItemImagePreview" class="image-preview empty">
                                <i class="fa-solid fa-image"></i> No image
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fa-solid fa-upload"></i> Update Image (Optional)</label>
                        <input class="modern-input" type="file" id="editItemImage" name="image" accept="image/*">
                        <small style="color:#666;">Leave empty to keep current image</small>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeEditModal()">
                            <i class="fa-solid fa-times"></i> Cancel
                        </button>
                        <button type="submit" class="modern-submit-btn">
                            <i class="fa-solid fa-save"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Staff Modal -->
    <div id="editStaffModal" class="modal-overlay">
        <div class="edit-modal">
            <div class="modal-header">
                <h3><i class="fa-solid fa-user-edit"></i> Edit Staff Member</h3>
                <button class="modal-close" onclick="closeEditStaffModal()">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editStaffForm" class="modal-form">
                    <input type="hidden" id="editStaffId" name="id">

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-user"></i> Full Name</label>
                            <input class="modern-input" type="text" id="editStaffName" name="name" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-briefcase"></i> Position</label>
                            <input class="modern-input" type="text" id="editStaffPosition" name="position" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-envelope"></i> Email</label>
                            <input class="modern-input" type="email" id="editStaffEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-phone"></i> Phone</label>
                            <input class="modern-input" type="tel" id="editStaffPhone" name="phone" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-building"></i> Department</label>
                            <select class="modern-input" id="editStaffDepartment" name="department" required>
                                <option value="">Select Department</option>
                                <option value="Kitchen">Kitchen</option>
                                <option value="Service">Service</option>
                                <option value="Delivery">Delivery</option>
                                <option value="Management">Management</option>
                                <option value="Marketing">Marketing</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-dollar-sign"></i> Salary</label>
                            <input class="modern-input" type="number" id="editStaffSalary" name="salary" min="0"
                                step="0.01">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fa-solid fa-calendar"></i> Hire Date</label>
                            <input class="modern-input" type="date" id="editStaffHireDate" name="hireDate">
                        </div>
                        <div class="form-group">
                            <label><i class="fa-solid fa-toggle-on"></i> Status</label>
                            <select class="modern-input" id="editStaffStatus" name="status" required>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="On Leave">On Leave</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fa-solid fa-file-alt"></i> CV/Resume</label>
                        <textarea class="modern-input" id="editStaffCv" name="cv" rows="4"
                            placeholder="Enter CV/Resume details..."></textarea>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeEditStaffModal()">
                            <i class="fa-solid fa-times"></i> Cancel
                        </button>
                        <button type="submit" class="modern-submit-btn">
                            <i class="fa-solid fa-save"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Navigation function
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav buttons
            document.querySelectorAll('.section-nav button').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName + '-section').classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Load section-specific data
            switch (sectionName) {
                case 'orders':
                    loadOrders();
                    break;
                case 'menu':
                    loadMenuItems();
                    loadCategories();
                    break;
                case 'ingredients':
                    loadIngredients();
                    break;
                case 'categories':
                    loadCategories();
                    break;
                case 'staff':
                    loadStaff();
                    break;
            }
        }

        // Load overview data
        async function loadOverview() {
            try {
                const [ordersResp, menuResp, staffResp, ingredientsResp] = await Promise.all([
                    fetch('php/get_orders.php'),
                    fetch('php/get_menu.php'),
                    fetch('php/get_staff.php'),
                    fetch('php/get_ingredients.php')
                ]);

                const orders = await ordersResp.json();
                const menu = await menuResp.json();
                const staff = await staffResp.json();
                const ingredientsData = await ingredientsResp.json();
                const ingredients = ingredientsData.ingredients || [];

                // Calculate totals
                const totalOrders = orders.length;
                const totalRevenue = orders.reduce((sum, order) => {
                    const items = Array.isArray(order.items) ? order.items : [order];
                    return sum + items.reduce((itemSum, item) => itemSum + (parseFloat(item.price) * (item.quantity || 1)), 0);
                }, 0);

                // Calculate ingredient statistics
                const totalIngredients = ingredients.length;
                const lowStockItems = ingredients.filter(ing => (ing.initialStock || 0) < 200).length;

                // Update display
                document.getElementById('totalOrders').textContent = totalOrders;
                document.getElementById('totalRevenue').textContent = '$' + totalRevenue.toFixed(2);
                document.getElementById('totalMenuItems').textContent = menu.length;
                document.getElementById('totalStaff').textContent = staff.length;
                document.getElementById('totalIngredients').textContent = totalIngredients;
                document.getElementById('lowStockItems').textContent = lowStockItems;

                // Highlight low stock warning
                if (lowStockItems > 0) {
                    document.getElementById('lowStockItems').style.color = '#ff5722';
                }
            } catch (error) {
                console.error('Error loading overview:', error);
                // Set default values if there's an error
                document.getElementById('totalOrders').textContent = '0';
                document.getElementById('totalRevenue').textContent = '$0.00';
                document.getElementById('totalMenuItems').textContent = '0';
                document.getElementById('totalStaff').textContent = '0';
                document.getElementById('totalIngredients').textContent = '0';
                document.getElementById('lowStockItems').textContent = '0';
            }
        }

        // Load orders
        async function loadOrders() {
            try {
                const resp = await fetch('php/get_orders.php');
                const orders = await resp.json();

                const ordersList = document.getElementById('ordersList');
                if (!orders.length) {
                    ordersList.innerHTML = '<p style="text-align:center;color:#888;font-size:20px;">No orders yet.</p>';
                    return;
                }

                ordersList.innerHTML = `
                    <div style="margin-top:20px;">
                        <h3 style="color:#ff5722;font-size:24px;margin-bottom:16px;">All Customer Orders</h3>
                        <table class="dashboard-table">
                            <thead>
                                <tr>
                                    <th>Order #</th>
                                    <th>Customer</th>
                                    <th>Items</th>
                                    <th>Total</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${orders.map((order, index) => {
                    const items = Array.isArray(order.items) ? order.items : [order];
                    const total = items.reduce((sum, item) => sum + (parseFloat(item.price) * (item.quantity || 1)), 0);
                    const customer = order.customer || order.username || 'Guest';
                    const timestamp = order.timestamp || 'N/A';
                    const status = order.status || 'Pending';

                    return `
                                        <tr>
                                            <td style="font-weight:bold;color:#ff5722;">#${index + 1}</td>
                                            <td style="font-weight:bold;">${customer}</td>
                                            <td style="text-align:left;max-width:300px;">
                                                ${items.map(item => `
                                                    <div style="margin-bottom:4px;">
                                                        â€¢ ${item.name} (${item.quantity || 1}x) - $${parseFloat(item.price).toFixed(2)}
                                                    </div>
                                                `).join('')}
                                            </td>
                                            <td style="font-weight:bold;color:#388e3c;font-size:18px;">$${total.toFixed(2)}</td>
                                            <td>${timestamp}</td>
                                            <td>
                                                <span style="background:#ff9800;color:#fff;padding:4px 8px;border-radius:8px;font-size:14px;">
                                                    ${status}
                                                </span>
                                            </td>
                                        </tr>
                                    `;
                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading orders:', error);
                document.getElementById('ordersList').innerHTML = '<p style="text-align:center;color:#ff5722;font-size:20px;">Error loading orders. Please try again.</p>';
            }
        }

        // Load menu items
        async function loadMenuItems() {
            try {
                const resp = await fetch('php/get_menu.php');
                const menu = await resp.json();

                const menuList = document.getElementById('menuItemsList');
                if (!menu.length) {
                    menuList.innerHTML = '<p style="text-align:center;color:#888;font-size:20px;">No menu items yet. Add your first menu item using the form above!</p>';
                    return;
                }

                menuList.innerHTML = `
                    <div style="margin-top:20px;">
                        <h3 style="color:#ff5722;font-size:24px;margin-bottom:16px;">Current Menu Items (${menu.length} items)</h3>
                        <table class="dashboard-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Category</th>
                                    <th>Price</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${menu.map(item => `
                                    <tr>
                                        <td>
                                            ${item.image ?
                        `<img src="${item.image}" alt="${item.name}" style="width:60px;height:60px;object-fit:cover;border-radius:8px;">` :
                        `<div style="width:60px;height:60px;background:#f0f0f0;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#999;">
                                                    <i class="fa-solid fa-image"></i>
                                                </div>`
                    }
                                        </td>
                                        <td style="font-weight:bold;color:#ff5722;">${item.name}</td>
                                        <td style="max-width:200px;">${item.description}</td>
                                        <td>
                                            <span style="background:#ffe0b2;color:#ff5722;padding:4px 8px;border-radius:8px;font-size:14px;">
                                                ${item.category}
                                            </span>
                                        </td>
                                        <td style="font-weight:bold;color:#388e3c;font-size:18px;">$${parseFloat(item.price).toFixed(2)}</td>
                                        <td>
                                            <button class="edit-btn" onclick="editMenuItem('${item.name}')" title="Edit">
                                                <i class="fa-solid fa-edit"></i>
                                            </button>
                                            <button class="delete-btn" onclick="deleteMenuItem('${item.name}')" title="Delete">
                                                <i class="fa-solid fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading menu items:', error);
                document.getElementById('menuItemsList').innerHTML = '<p style="text-align:center;color:#ff5722;font-size:20px;">Error loading menu items. Please try again.</p>';
            }
        }

        // Load ingredients
        async function loadIngredients() {
            try {
                const resp = await fetch('php/get_ingredients.php');
                const data = await resp.json();
                const ingredients = data.ingredients || [];

                const ingredientsList = document.getElementById('ingredientsList');
                if (!ingredients.length) {
                    ingredientsList.innerHTML = '<p style="text-align:center;color:#888;font-size:20px;">No ingredients yet.</p>';
                    return;
                }

                ingredientsList.innerHTML = `
                    <div style="margin-top:20px;">
                        <h3 style="color:#ff5722;font-size:24px;margin-bottom:16px;">Current Ingredients & Stock</h3>
                        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;">
                            ${ingredients.map(ingredient => {
                    const stock = ingredient.initialStock || 0;
                    const isLowStock = stock < 200;
                    const stockColor = isLowStock ? '#ff5722' : (stock < 500 ? '#ff9800' : '#388e3c');
                    const stockStatus = isLowStock ? 'LOW STOCK!' : (stock < 500 ? 'Medium' : 'Good');

                    return `
                                    <div style="background:#f9f9f9;border-radius:12px;padding:16px;border:2px solid ${isLowStock ? '#ff5722' : '#eee'};">
                                        <div style="font-size:20px;color:#ff5722;font-weight:bold;margin-bottom:8px;">
                                            ${ingredient.displayName || ingredient.name}
                                        </div>
                                        <div style="font-size:16px;color:#666;margin-bottom:4px;">
                                            Category: ${ingredient.category}
                                        </div>
                                        <div style="font-size:18px;color:${stockColor};font-weight:bold;margin-bottom:4px;">
                                            Stock: ${stock} ${ingredient.unit || 'g'}
                                        </div>
                                        <div style="font-size:14px;color:${stockColor};font-weight:bold;margin-bottom:8px;">
                                            Status: ${stockStatus}
                                        </div>
                                        <button class="ingredient-delete" onclick="deleteIngredient('${ingredient.name}')" 
                                                style="background:#ff5722;color:#fff;border:none;border-radius:8px;padding:6px 12px;font-size:14px;cursor:pointer;">
                                            <i class="fa-solid fa-trash"></i> Delete
                                        </button>
                                    </div>
                                `;
                }).join('')}
                        </div>
                    </div>
                `;

                // Update restock dropdown
                const restockSelect = document.getElementById('restockIngredient');
                restockSelect.innerHTML = ingredients.map(ing => {
                    const stock = ing.initialStock || 0;
                    const isLowStock = stock < 200;
                    const stockIndicator = isLowStock ? ' (LOW STOCK!)' : '';
                    return `<option value="${ing.name}">${ing.displayName || ing.name} (${stock} ${ing.unit || 'g'})${stockIndicator}</option>`;
                }).join('');
            } catch (error) {
                console.error('Error loading ingredients:', error);
            }
        }

        // Load categories
        async function loadCategories() {
            try {
                const resp = await fetch('php/categories.json');
                const categories = await resp.json();

                const categoriesList = document.getElementById('categoriesList');
                if (!categories.length) {
                    categoriesList.innerHTML = '<p style="text-align:center;color:#888;font-size:20px;">No categories yet.</p>';
                    return;
                }

                categoriesList.innerHTML = `
                    <div style="margin-top:20px;">
                        <h3 style="color:#ff5722;font-size:24px;margin-bottom:16px;">Current Categories</h3>
                        <div>
                            ${categories.map(category => `
                                <span class="category-item">
                                    ${category}
                                    <button class="category-delete" onclick="deleteCategory('${category}')" title="Delete">
                                        <i class="fa-solid fa-times"></i>
                                    </button>
                                </span>
                            `).join('')}
                        </div>
                    </div>
                `;

                // Update category dropdowns
                const addCategorySelect = document.getElementById('addCategorySelect');
                if (addCategorySelect) {
                    addCategorySelect.innerHTML = categories.map(cat =>
                        `<option value="${cat}">${cat}</option>`
                    ).join('');
                }
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }

        // Load staff
        async function loadStaff() {
            try {
                const resp = await fetch('php/get_staff.php');
                const staff = await resp.json();

                const staffList = document.getElementById('staffList');
                if (!staff.length) {
                    staffList.innerHTML = '<p style="text-align:center;color:#888;font-size:20px;">No staff members yet.</p>';
                    return;
                }

                staffList.innerHTML = staff.map(member => `
                    <div class="staff-card">
                        <div class="staff-name">${member.name}</div>
                        <div class="staff-position">${member.position}</div>
                        <div class="staff-contact">${member.email}</div>
                        <div class="staff-contact">${member.phone}</div>
                        <div class="staff-contact">${member.department}</div>
                        <div class="staff-actions">
                            <button class="edit-btn" onclick="editStaff(${member.id})">
                                <i class="fa-solid fa-edit"></i> Edit
                            </button>
                            <button class="delete-btn" onclick="deleteStaff(${member.id})">
                                <i class="fa-solid fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading staff:', error);
            }
        }

        // Form handlers
        document.getElementById('addMenuItemForm').onsubmit = async function (e) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            const msg = document.getElementById('addMenuItemMsg');

            msg.textContent = 'Adding menu item...';

            try {
                const resp = await fetch('php/save_menu.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Menu item added successfully!';
                    msg.style.color = '#4CAF50';
                    form.reset();
                    loadMenuItems();
                } else {
                    msg.textContent = data.error || 'Failed to add menu item.';
                    msg.style.color = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error adding menu item.';
                msg.style.color = '#ff5722';
            }
        };

        document.getElementById('addIngredientForm').onsubmit = async function (e) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            const msg = document.getElementById('addIngredientMsg');

            msg.textContent = 'Adding ingredient...';

            try {
                const resp = await fetch('php/add_ingredient.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Ingredient added successfully!';
                    msg.style.color = '#4CAF50';
                    form.reset();
                    loadIngredients();
                } else {
                    msg.textContent = data.error || 'Failed to add ingredient.';
                    msg.style.color = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error adding ingredient.';
                msg.style.color = '#ff5722';
            }
        };

        document.getElementById('addCategoryForm').onsubmit = async function (e) {
            e.preventDefault();
            const input = document.getElementById('newCategoryInput');
            const msg = document.getElementById('addCategoryMsg');
            const category = input.value.trim();

            if (!category) {
                msg.textContent = 'Please enter a category name.';
                return;
            }

            msg.textContent = 'Adding category...';

            try {
                const resp = await fetch('php/add_category.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category })
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Category added successfully!';
                    msg.style.color = '#4CAF50';
                    input.value = '';
                    loadCategories();
                } else {
                    msg.textContent = data.error || 'Failed to add category.';
                    msg.style.color = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error adding category.';
                msg.style.color = '#ff5722';
            }
        };

        document.getElementById('addStaffForm').onsubmit = async function (e) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            const msg = document.getElementById('addStaffMsg');

            msg.textContent = 'Adding staff member...';

            try {
                const resp = await fetch('php/add_staff.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Staff member added successfully!';
                    msg.style.color = '#4CAF50';
                    form.reset();
                    loadStaff();
                } else {
                    msg.textContent = data.error || 'Failed to add staff member.';
                    msg.style.color = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error adding staff member.';
                msg.style.color = '#ff5722';
            }
        };

        document.getElementById('restockForm').onsubmit = async function (e) {
            e.preventDefault();
            const ingredient = document.getElementById('restockIngredient').value;
            const amount = parseFloat(document.getElementById('restockAmount').value);
            const unit = document.getElementById('restockUnit').value;
            const msg = document.getElementById('restockMsg');

            if (!ingredient || !amount) {
                msg.textContent = 'Please fill in all fields.';
                return;
            }

            // Convert to grams
            let amountInGrams = amount;
            switch (unit) {
                case 'kg': amountInGrams = amount * 1000; break;
                case 'oz': amountInGrams = amount * 28.35; break;
                case 'lb': amountInGrams = amount * 453.59; break;
                default: amountInGrams = amount; break;
            }

            msg.textContent = 'Restocking...';

            try {
                const resp = await fetch('php/restock_ingredient.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ingredient, amount: Math.round(amountInGrams) })
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = `Restocked ${amount}${unit} of ${ingredient}!`;
                    msg.style.color = '#4CAF50';
                    e.target.reset();
                } else {
                    msg.textContent = data.error || 'Failed to restock.';
                    msg.style.color = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error during restock.';
                msg.style.color = '#ff5722';
            }
        };

        // Edit functions
        window.editMenuItem = async function (name) {
            try {
                // Load menu data to get current item details
                const resp = await fetch('php/get_menu.php');
                const menu = await resp.json();

                const item = menu.find(item => item.name === name);
                if (!item) {
                    alert('Menu item not found');
                    return;
                }

                // Load categories for dropdown
                const categoriesResp = await fetch('php/categories.json');
                const categories = await categoriesResp.json();

                // Populate form fields
                document.getElementById('editItemName').value = item.name;
                document.getElementById('editItemNameInput').value = item.name;
                document.getElementById('editItemPrice').value = item.price;
                document.getElementById('editItemDescription').value = item.description;

                // Populate category dropdown
                const categorySelect = document.getElementById('editItemCategory');
                categorySelect.innerHTML = categories.map(cat =>
                    `<option value="${cat}" ${cat === item.category ? 'selected' : ''}>${cat}</option>`
                ).join('');

                // Show current image
                const imagePreview = document.getElementById('editItemImagePreview');
                if (item.image) {
                    imagePreview.innerHTML = `<img src="${item.image}" alt="${item.name}">`;
                    imagePreview.classList.remove('empty');
                } else {
                    imagePreview.innerHTML = '<i class="fa-solid fa-image"></i> No image';
                    imagePreview.classList.add('empty');
                }

                // Show modal
                document.getElementById('editMenuModal').classList.add('active');

            } catch (error) {
                console.error('Error loading menu item for editing:', error);
                alert('Error loading menu item details');
            }
        };

        window.closeEditModal = function () {
            document.getElementById('editMenuModal').classList.remove('active');
            document.getElementById('editMenuForm').reset();
        };

        // Handle edit form submission
        document.getElementById('editMenuForm').onsubmit = async function (e) {
            e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);
            const msg = document.createElement('div');
            msg.style.cssText = 'position:fixed;top:20px;right:20px;padding:15px;border-radius:8px;z-index:1001;';

            msg.textContent = 'Updating menu item...';
            msg.style.background = '#ff9800';
            msg.style.color = '#fff';
            document.body.appendChild(msg);

            try {
                const resp = await fetch('php/update_menu_item.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Menu item updated successfully!';
                    msg.style.background = '#4CAF50';
                    closeEditModal();
                    loadMenuItems();
                } else {
                    msg.textContent = data.error || 'Failed to update menu item.';
                    msg.style.background = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error updating menu item.';
                msg.style.background = '#ff5722';
            }

            // Remove message after 3 seconds
            setTimeout(() => {
                if (msg.parentNode) {
                    msg.parentNode.removeChild(msg);
                }
            }, 3000);
        };

        // Handle image preview in edit modal
        document.getElementById('editItemImage').onchange = function (e) {
            const file = e.target.files[0];
            const preview = document.getElementById('editItemImagePreview');

            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                    preview.classList.remove('empty');
                };
                reader.readAsDataURL(file);
            }
        };

        // Close modal when clicking outside
        document.getElementById('editMenuModal').onclick = function (e) {
            if (e.target === this) {
                closeEditModal();
            }
        };

        // Close staff modal when clicking outside
        document.getElementById('editStaffModal').onclick = function (e) {
            if (e.target === this) {
                closeEditStaffModal();
            }
        };

        // Close modal with Escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeEditModal();
                closeEditStaffModal();
            }
        });

        window.editStaff = async function (id) {
            try {
                // Load staff data to get current member details
                const resp = await fetch('php/get_staff.php');
                const staff = await resp.json();

                const member = staff.find(m => m.id === id);
                if (!member) {
                    alert('Staff member not found');
                    return;
                }

                // Populate form fields
                document.getElementById('editStaffId').value = member.id;
                document.getElementById('editStaffName').value = member.name;
                document.getElementById('editStaffPosition').value = member.position;
                document.getElementById('editStaffEmail').value = member.email;
                document.getElementById('editStaffPhone').value = member.phone;
                document.getElementById('editStaffDepartment').value = member.department;
                document.getElementById('editStaffSalary').value = member.salary;
                document.getElementById('editStaffHireDate').value = member.hireDate;
                document.getElementById('editStaffStatus').value = member.status;
                document.getElementById('editStaffCv').value = member.cv;

                // Show modal
                document.getElementById('editStaffModal').classList.add('active');

            } catch (error) {
                console.error('Error loading staff member for editing:', error);
                alert('Error loading staff member details');
            }
        };

        window.closeEditStaffModal = function () {
            document.getElementById('editStaffModal').classList.remove('active');
            document.getElementById('editStaffForm').reset();
        };

        // Handle edit form submission
        document.getElementById('editStaffForm').onsubmit = async function (e) {
            e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);
            const msg = document.createElement('div');
            msg.style.cssText = 'position:fixed;top:20px;right:20px;padding:15px;border-radius:8px;z-index:1001;';

            msg.textContent = 'Updating staff member...';
            msg.style.background = '#ff9800';
            msg.style.color = '#fff';
            document.body.appendChild(msg);

            try {
                const resp = await fetch('php/update_staff.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await resp.json();

                if (data.success) {
                    msg.textContent = 'Staff member updated successfully!';
                    msg.style.background = '#4CAF50';
                    closeEditStaffModal();
                    loadStaff();
                } else {
                    msg.textContent = data.error || 'Failed to update staff member.';
                    msg.style.background = '#ff5722';
                }
            } catch (error) {
                msg.textContent = 'Error updating staff member.';
                msg.style.background = '#ff5722';
            }

            // Remove message after 3 seconds
            setTimeout(() => {
                if (msg.parentNode) {
                    msg.parentNode.removeChild(msg);
                }
            }, 3000);
        };

        // Delete functions
        window.deleteCategory = async function (category) {
            if (!confirm(`Delete category "${category}"?`)) return;

            try {
                const resp = await fetch('php/delete_category.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category })
                });
                const data = await resp.json();

                if (data.success) {
                    loadCategories();
                } else {
                    alert(data.error || 'Failed to delete category.');
                }
            } catch (error) {
                alert('Error deleting category.');
            }
        };

        window.deleteIngredient = async function (ingredient) {
            if (!confirm(`Delete ingredient "${ingredient}"?`)) return;

            try {
                const resp = await fetch('php/delete_ingredient.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ingredient })
                });
                const data = await resp.json();

                if (data.success) {
                    loadIngredients();
                } else {
                    alert(data.error || 'Failed to delete ingredient.');
                }
            } catch (error) {
                alert('Error deleting ingredient.');
            }
        };

        window.deleteMenuItem = async function (name) {
            if (!confirm(`Delete menu item "${name}"?`)) return;

            try {
                const resp = await fetch('php/delete_menu_item.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name })
                });
                const data = await resp.json();

                if (data.success) {
                    loadMenuItems();
                } else {
                    alert(data.error || 'Failed to delete menu item.');
                }
            } catch (error) {
                alert('Error deleting menu item.');
            }
        };

        window.deleteStaff = async function (id) {
            if (!confirm('Delete this staff member?')) return;

            try {
                const resp = await fetch('php/delete_staff.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id })
                });
                const data = await resp.json();

                if (data.success) {
                    loadStaff();
                } else {
                    alert(data.error || 'Failed to delete staff member.');
                }
            } catch (error) {
                alert('Error deleting staff member.');
            }
        };

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function () {
            loadOverview();
            loadOrders(); // Load initial section
        });
    </script>
</body>

</html>